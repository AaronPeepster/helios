#!/bin/bash -e
dir="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

if [[ -e "$dir/../../helios" ]]; then
    jar="$(ls -t $dir/../target/helios*.jar | grep -v sources | grep -v javadoc | head -n 1)"
    jar="$(cd $(dirname $jar) && pwd -P)/$(basename $jar)"
    echo "running in helios project, using $jar" 1>&2
else
    jar="/usr/share/java/spotify-helios.jar"
fi

exec java \
    -Djava.net.preferIPv4Stack=true \
    -client \
    -Xverify:none \
    -cp "$jar" \
    com.spotify.helios.cli.CliMain \
    "$@"
